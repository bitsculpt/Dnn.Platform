@inherits Dnn.Mvc.Web.Framework.Modules.DnnWebViewPage<Dnn.Mvc.Modules.Html.Models.HtmlText>

@using System.Web.Mvc.Html
@using Dnn.Mvc.Web.Helpers
           
<div>
    <div class="form-horizontal" role="form">
        @*@Html.AntiForgeryToken()*@
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(m => m.Content, new { @class = "col-md-2 control-label" })
            <div class="col-md-10">
                @Html.TextAreaFor(m => m.Content, 5, 40, new { @class = "form-control", id = "HtmlContent" })
            </div>
        </div>
    </div>
</div>
<div class="modal-footer" id="moduleActions">
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    <button id="saveButton" class="btn btn-primary">Save</button>
</div>

<script type="text/javascript">
    $(document).ready(function() {
        $("#moduleActions button.btn-primary").click(function () {
            $.ajax({
                url: "@Dnn.Action("Edit")",
                datatype: "html",
                type: "POST",
                data: {
                    "ItemID" : "@Model.ItemID",
                    "ModuleID": "@Model.ModuleID",
                    "Content": $("#HtmlContent").val(),
                    "Version" : "@Model.Version"
                },
                success: function(result) {
                    if (result.Success) {
                        $(".modal").modal("hide");
                        window.location = "@Url.Action("Index", "Page", new { page = Dnn.ActivePage })";
                    }
                },
                error: function(xhr, status) {

                }
            });
        });
    });
</script>